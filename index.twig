{% set submissionString = '' %}

{% set submissionString = submissionString ~ 'Submitted on: ' ~ webform_token('[webform_submission:created]', webform_submission, [], options) ~ '\n' %}
{% set submissionString = submissionString ~ 'Submitted by: ' ~ webform_token('[webform_submission:user]', webform_submission, [], options) ~ '\n' %}
{% set submissionString = submissionString ~ 'Submitted from: ' ~ webform_token('[webform:title]', webform, [], options) ~ '\n\n' %}

{% set elements_list = 
  [
  'spacebreak',
  'print_line',
  'spacebreak | 4',
  'print_line | bolded',
  'print_text | I really hope this works',
  'print_section | submitter_information',
  'spacebreak | 2',
  'print_section_title | submission_section',
  'optional_text',
  'pizza_toppings',
  'spiciness',
  'cheesiness',
  'drinks_option',
  'spacebreak | 4',
  'print_section | submission_section',
  'spacebreak | 4',
  'print_text | Invalid commands and keys here:',
  'pizza_topping',
  'print_section',
  'print_section | submission_sect',
  ]
%}

{% for element in elements_list %}

  {% set elementSplit = element|split(" ") %}
  {% set elementSplitLength = elementSplit|length() %} 

  {% if elementSplitLength == 1 %}


    {% set elementName = elementSplit[0] %}

    {% if (elementName != 'break') and ('webform_submission' not in webform_token('[webform_submission:values:'~elementName~']', webform_submission)) %}
      {{ webform_token('[webform:element:'~elementName~ ':title:html]', webform)|render_html_specialchars }}:  {{ webform_token('[webform_submission:values:'~elementName~']', webform_submission)|render_html_specialchars }}

    {% elseif (elementName == 'spacebreak') %}
      '
    {% else %}
      **
      ** {{ element }} is not a valid key **
      **
    {% endif %}

  
  {% elseif elementSplitLength == 2 %}


    {% set command = elementSplit[0] %}
    {% set elementName = elementSplit[1] %}

    {% if command == 'spacebreak' %}
      {% for number in 1..(elementSplit[1] * 1) %}
        '
      {% endfor %}

    {% elseif (command != 'spacebreak') and ('webform_submission' not in webform_token('[webform_submission:values:'~elementName~']', webform_submission)) %}
      
      {% if command == 'print_section' %}
        {% if webform_token('[webform_submission:values:'~elementName~']', webform_submission)|render_html_specialchars is not empty %}
        {{ webform_token('[webform_submission:values:'~elementName~']', webform_submission)|render_html_specialchars }}
        {% endif %}

      {% elseif command == 'print_section_title' %}
        {{ webform_token('[webform:element:'~elementName~ ':title]', webform)|render_html_specialchars }}
        ----
      {% else %}
        **      
        **{{ command }} is not a valid command. 
        **
      {% endif %}

    {% else %}
      **   
      **{{ element }} is not a valid key
      **
    {% endif %}


  {% else %}

    **
    ** {{ element }} is not a valid format. Use the pattern: 'element_key' or 'break' or '[command] element_key' or 'break [number]' 
    **

  {% endif %}

{% endfor %}
